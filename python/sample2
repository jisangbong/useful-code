
UPDATE table_a a
SET (a.val1, a.val2) = (
    SELECT b.new_val1, b.new_val2
    FROM table_b b
    JOIN table_c c ON c.b_ref_id = b.ref_id
    WHERE c.a_id = a.id
)
WHERE EXISTS (
    SELECT 1
    FROM table_b b
    JOIN table_c c ON c.b_ref_id = b.ref_id
    WHERE c.a_id = a.id
);

MERGE INTO table_a a
USING (
    SELECT a.id AS a_id, b.new_val1, b.new_val2
    FROM table_c c
    JOIN table_a a ON a.id = c.a_id
    JOIN table_b b ON b.ref_id = c.b_ref_id
) src
ON (a.id = src.a_id)
WHEN MATCHED THEN
  UPDATE SET
    a.val1 = src.new_val1,
    a.val2 = src.new_val2;
